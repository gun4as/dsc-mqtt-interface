# DSC MQTT Interface

ESP8266 projekts, kas pieslÄ“dzas DSC signalizÄcijas panelim caur Keybus un nosÅ«ta statusus uz MQTT brokeri, kÄ arÄ« saÅ†em komandas no Home Assistant vai citas automatizÄcijas sistÄ“mas.

---

## TastatÅ«ras UI piemÄ“rs

ZemÄk redzams Home Assistant tastatÅ«ras interfeisa piemÄ“rs, kas darbojas kopÄ ar Å¡o integrÄciju:

![DSC tastatÅ«ras UI](extras/homeassistant/hslovecase.png)

---

## SistÄ“mas prasÄ«bas

- ESP8266 mikrokontrolleris (piemÄ“ram, D1 Mini)
- DSC signalizÄcijas panelis ar Keybus
- MQTT brokeris (piem., Mosquitto)
- PlatformIO (VSCode paplaÅ¡inÄjums)

---

## InstalÄcija

1. **KlonÄ“ repozitoriju**

   Atver VSCode un klonÄ“ Å¡o repozitoriju kÄ PlatformIO projektu.

2. **Sagatavo konfigurÄcijas failu**

   FailÄ `src/config_template.cpp` ir parauga iestatÄ«jumi.

   - NokopÄ“ Å¡o failu uz `src/config.cpp`
   - Atver `src/config.cpp` un ievadi savus datus:

     ```cpp
     const char * wifiSSID = "Tavs_WiFi";
     const char * wifiPassword = "Tava_parole";
     const char * accessCode = "1234";
     const char * mqttServer = "192.168.1.10";
     const char * mqttUsername = "mqtt";
     const char * mqttPassword = "parole";
     const int mqttPort = 1883;
     ```

   ğŸ“Œ **Fails `config.cpp` ir iekÄ¼auts `.gitignore` â€” tas netiks augÅ¡upielÄdÄ“ts uz GitHub.**

3. **KompilÄ“ un augÅ¡upielÄdÄ“ uz ESP8266**

   PlatformIO iekÅ¡ VSCode:
   - Spied **Upload** vai izmanto PlatformIO komandu logu:

     ```bash
     platformio run
     platformio upload
     ```

4. **PÄrbaudi seriÄlajÄ monitorÄ**, vai ierÄ«ce pieslÄ“dzas WiFi un MQTT.

---

## MQTT Topiki (nosÅ«tÄ«Å¡ana / saÅ†emÅ¡ana)

| TÄ“ma | Apraksts |
|------|----------|
| `DSC/Get/Zone1 ... Zone64` | ZonÄ“m individuÄli |
| `DSC/Get/Partition1 ...`   | Partition statusi |
| `DSC/Get/Trouble`          | TraucÄ“jumu ziÅ†ojumi |
| `DSC/Get/Fire1`, ...       | UgunsdroÅ¡Ä«bas statuss |
| `DSC/Set/Partition1`       | Komandas: arm, disarm u.c. |

---

## DroÅ¡Ä«ba

âš ï¸ **Fails `config.cpp` satur sensitÄ«vu informÄciju!**
Tas netiek saglabÄts repozitorijÄ (`.gitignore`) un ir jÄuztur lokÄli.

---

## IespÄ“jamÄs problÄ“mas

- Ja WiFi nav pieejams, ierÄ«ce mÄ“Ä£ina atkÄrtoti pieslÄ“gties.
- Ja MQTT brokeris nav pieejams, tiek mÄ“Ä£inÄta atkÄrtota pieslÄ“gÅ¡anÄs.
- PÄ“c daudziem neveiksmÄ«giem mÄ“Ä£inÄjumiem ESP automÄtiski restartÄ“jas.

---

## PlÄnotie uzlabojumi

- Web konfigurÄcijas saskarne (hotspot + iestatÄ«jumi)
- OTA atjauninÄÅ¡ana
- SistÄ“mas diagnostika caur MQTT

---

## Licence

Projekts izplatÄ«ts saskaÅ†Ä ar GNU GPL v3 licenci.

Pamats: [taligentx/dscKeybusInterface](https://github.com/taligentx/dscKeybusInterface)

---
